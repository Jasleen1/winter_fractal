# Introduction
This repository contains code for an implementation of the [Fractal proof system]
(https://eprint.iacr.org/2019/1076) and building on the math and cryptography libraries implemented in (Winterfell)[https://github.com/facebook/winterfell]. 

Fractal is meant to prove R1CS instances and  it does so using one component called `Lincheck` and another called `Rowcheck`. The paper describes these components and their building blocks modularly and shows the interactive versions of these protocols in the Interactive Oracle Proof (IOP) model. The proof is then made non-interactive using commitments and relying on the Random Oracle Model (ROM) to draw queries. 

**Current State** Currently, the `main` branch of this code is an unoptimized, modular implementation mirroring the paper, making it easier to understand the paper's construction. However, to fairly compare this code with Winterfell's AIR-based implementation, we need several optimizations as well as batching of simulataneously committed IOP statements. The branch `matrix_opt` is up-to-date with this optimization as well as several others. Also, note that the Fractal paper was originally meant to implement recursion, but we haven't yet implemented the constraints for a Fractal verifier and hence this repository currently offers no recursion.

**Historical Note** The underlying code for this repository was initially committed in various branch of [@Jasleen1's fork of Winterfell](https://github.com/Jasleen1/winterfell), but they only used the upsteam repository [winterfell](https://github.com/novifinancial/winterfell) as a pure dependency. This repository is has now transitioned to using the [winterfell crate](https://crates.io/crates/winterfell/0.4.0/dependencies) instead. The initial commit to this repository contains the code written elsewhere by @Jasleen1. 

# Code Oraganization
In this work, we organize the code as a Rust workspace with the following crates:
* `fractal_accumulator`: This repository contains a prover-side accumulator for polynomials that allows batch evaluation of, committments to and queries to, said polynomials. This is needed in the setting where we would like to combine the proofs from the various parallel components of the Fractal prover. 
* `fractal_accumulator_verifier`: This is the corresponding verifier which checks that batch evaluations of polynomials are valid with respect to a commitment. 
* `fractal_examples`: This repository contains an end-to-end fractal example that can also be run with files encoding different R1CS instances generated by the [jsnark tool](https://github.com/Jasleen1/jsnark/tree/gen-arith), which were then exported into the relevant locations. 
* `fractal_indexer`: This crate contains functions and structs required for Fractal's pre-processing step. 
* `fractal_math`: This is a small crate with some of the math operations needed for Fractal. Note that some of the functions here are essentially copies of the corresponding functions in Winterfell but with requisite modifications made for fractal. We also have some small fields defined here to make testing easier. So far, not too many tests include these fields, this is something we hope to get to. 
* `fractal_proofs`: This crate contains structs for fractal proofs and their corresponding operations. 
* `fractal_prover`: This is the crate containing the prover for fractal as well as more general traits for provers of IOPs. 
* `fractal_utils`: This crate mainly contains general utilities needed for various operations. 
* `fractal_verifier`: This is where the Fractal verifier and traits related to IOP verifiers reside. 
* `low_degree_prover`: This crate is meant to be for the prover of low degree of a given set of polynomials. At the moment it is a somewhat complex wrapper around the FRI crate from winterfell.
* `low_degree_verifier`: This is the verifier corresponding to the `low_degree_prover`.
* `models`: This crate contains the R1CS struct and various other structs modelling the arithmetization. 

